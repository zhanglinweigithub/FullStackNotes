import{_ as p,M as e,p as c,q as o,R as n,t as s,N as t,a1 as l}from"./framework-5866ffd3.js";const i="/FullStackNotes/assets/image-20230417221834973-75076425.png",u="/FullStackNotes/assets/image-20230417221848232-b55e0f8f.png",k={},d=n("h1",{id:"hutools",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#hutools","aria-hidden":"true"},"#"),s(" Hutools")],-1),r={href:"https://hutool.cn/docs/#/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://apidoc.gitee.com/dromara/hutool/",target:"_blank",rel:"noopener noreferrer"},m=l(`<p>官方文档写的比较清楚，我这里只是用到了就记录一下</p><p><strong>依赖</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.8.16<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="captcha" tabindex="-1"><a class="header-anchor" href="#captcha" aria-hidden="true">#</a> captcha</h2><h3 id="springboot-vue-前后端分离实现图片验证码功能" tabindex="-1"><a class="header-anchor" href="#springboot-vue-前后端分离实现图片验证码功能" aria-hidden="true">#</a> SpringBoot + vue 前后端分离实现图片验证码功能</h3><p><strong>1、引入依赖</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.8.16<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2、创建 Controller</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/captcha&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> getCaptcha <span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
	<span class="token comment">// 生成验证图片</span>
    <span class="token class-name">LineCaptcha</span> captcha <span class="token operator">=</span> <span class="token class-name">CaptchaUtil</span><span class="token punctuation">.</span><span class="token function">createLineCaptcha</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获得验证图片的值</span>
    <span class="token class-name">String</span> code <span class="token operator">=</span> captcha<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 存入 session 或 redis</span>
    session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 转换成图片 base64 编码形式</span>
    <span class="token class-name">String</span> base64Data <span class="token operator">=</span> captcha<span class="token punctuation">.</span><span class="token function">getImageBase64Data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkCAYAAADDhn8LAA... 超级长</span>
    <span class="token comment">// 返回给前端</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>base64Data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>LineCaptcha：线段干扰的验证码</p><p>CircleCaptcha：圆圈干扰验证码</p><p>ShearCaptcha：扭曲干扰验证码</p><p>GifCaptcha：gif 验证码</p></div><p><strong>3、浏览器测试效果</strong></p><p><img src="`+i+'" alt="image-20230417221834973"></p><p><img src="'+u+`" alt="image-20230417221848232"></p><p><strong>4、前端代码</strong></p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token comment">&lt;!-- 添加点击事件，实现点击更新验证图片 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>captcha<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getCaptcha<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">captcha</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 页面加载时获取验证图片</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCaptcha</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">getCaptcha</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">/user/captcha</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>captcha <span class="token operator">=</span> data<span class="token punctuation">.</span>data
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;获取验证码失败&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>    
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="captchautil-工具类" tabindex="-1"><a class="header-anchor" href="#captchautil-工具类" aria-hidden="true">#</a> CaptchaUtil 工具类</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 创建圆圈干扰的验证码，指定图片大小，默认5位验证码，15个干扰圈</span>
<span class="token function">createCircleCaptcha</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span>	
<span class="token comment">// 指定图片大小，验证码位数，干扰圈数</span>
<span class="token function">createCircleCaptcha</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">,</span> <span class="token keyword">int</span> codeCount<span class="token punctuation">,</span> <span class="token keyword">int</span> circleCount<span class="token punctuation">)</span>

<span class="token comment">// 创建GIF验证码</span>
<span class="token function">createGifCaptcha</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span>
<span class="token function">createGifCaptcha</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">,</span> <span class="token keyword">int</span> codeCount<span class="token punctuation">)</span>

<span class="token comment">// 创建线干扰的验证码，默认5位验证码，150条干扰线 </span>
<span class="token function">createLineCaptcha</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span>
<span class="token function">createLineCaptcha</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">,</span> <span class="token keyword">int</span> codeCount<span class="token punctuation">,</span> <span class="token keyword">int</span> lineCount<span class="token punctuation">)</span>
    
<span class="token comment">// 创建扭曲干扰的验证码，默认5位验证码</span>
<span class="token function">createShearCaptcha</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span>
<span class="token function">createShearCaptcha</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">,</span> <span class="token keyword">int</span> codeCount<span class="token punctuation">,</span> <span class="token keyword">int</span> thickness<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>width：图片宽</li><li>height：图片高</li><li>codeCount：字符位数</li><li>circleCount：干扰圈数</li><li>lineCount：干扰线数</li><li>thickness：干扰线宽度</li></ul><h3 id="abstractcaptcha-方法" tabindex="-1"><a class="header-anchor" href="#abstractcaptcha-方法" aria-hidden="true">#</a> AbstractCaptcha 方法</h3><p>所有的生成验证图片实现类均继承自 AbstractCaptcha</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 获取验证码的文字内容</span>
           
<span class="token class-name">CodeGenerator</span> <span class="token function">getGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 获取验证码生成器   </span>
    
<span class="token class-name">String</span> <span class="token function">getImageBase64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 获得图片的Base64形式</span>
    
<span class="token class-name">String</span> <span class="token function">getImageBase64Data</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 获取图片带文件格式的 Base64</span>
    
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getImageBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 获取图形验证码图片bytes</span>
    
<span class="token keyword">void</span> <span class="token function">setBackground</span><span class="token punctuation">(</span><span class="token class-name">Color</span> background<span class="token punctuation">)</span>
<span class="token comment">// 设置背景色</span>
    
<span class="token keyword">void</span> <span class="token function">setFont</span><span class="token punctuation">(</span><span class="token class-name">Font</span> font<span class="token punctuation">)</span>
<span class="token comment">// 自定义字体</span>
    
<span class="token keyword">void</span> <span class="token function">setGenerator</span><span class="token punctuation">(</span><span class="token class-name">CodeGenerator</span> generator<span class="token punctuation">)</span>
<span class="token comment">// 设置验证码生成器</span>
    
<span class="token keyword">void</span> <span class="token function">setTextAlpha</span><span class="token punctuation">(</span><span class="token keyword">float</span> textAlpha<span class="token punctuation">)</span>
<span class="token comment">// 设置文字透明度</span>
    
<span class="token keyword">boolean</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token class-name">String</span> userInputCode<span class="token punctuation">)</span>
<span class="token comment">// 验证验证码是否正确，建议忽略大小写</span>
    
<span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span>
<span class="token comment">// 验证码写出到文件</span>
    
<span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> out<span class="token punctuation">)</span>
<span class="token comment">// 将验证码写出到目标流中</span>
    
<span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span>
<span class="token comment">// 验证码写出到文件</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,21);function g(b,h){const a=e("ExternalLinkIcon");return c(),o("div",null,[d,n("p",null,[s("官网："),n("a",r,[s("https://hutool.cn/docs/#/"),t(a)])]),n("p",null,[s("API 文档："),n("a",v,[s("https://apidoc.gitee.com/dromara/hutool/"),t(a)])]),m])}const w=p(k,[["render",g],["__file","Hutools.html.vue"]]);export{w as default};
